{% extends "base.html" %}

{% block content %}
<div class="mb-6">
    <p class="text-xs uppercase tracking-[0.3em] text-slate-400 mb-1">{{ t("cats_label", lang) }}</p>
    <h1 class="text-2xl font-semibold">{{ t("cats_title", lang) }}</h1>
    <p class="text-slate-400 text-sm">{{ t("cats_subtitle", lang) }}</p>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-4 shadow-lg shadow-black/40">
        <h2 class="text-lg font-semibold mb-3">{{ t("add_cat", lang) }}</h2>
        <form method="post" action="/cats?lang={{ lang }}" enctype="multipart/form-data" class="space-y-3">
            <input type="hidden" name="csrf_token" value="{{ request.session.get('csrf_token') }}">
            <div class="grid grid-cols-1 gap-2 text-sm">
                <input name="name" placeholder="{{ t('cat_name_label', lang) }}" required class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-3 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <input name="color" placeholder="{{ t('cat_color_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-3 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <input type="date" name="birthday" placeholder="{{ t('cat_birthday_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-3 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <input name="chip_id" placeholder="{{ t('cat_chip_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-3 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <div class="flex items-center gap-2 text-sm">
                    <label class="text-slate-400 w-32 text-left">{{ t("cat_photo_label", lang) }}</label>
                    <input type="file" name="photo" accept="image/*" class="text-xs text-slate-300">
                </div>
            </div>
            <button type="submit" class="w-full bg-emerald-500/90 hover:bg-emerald-500 text-slate-950 font-semibold py-3 rounded-xl transition shadow-lg shadow-emerald-500/20">{{ t("save_cat", lang) }}</button>
        </form>
    </div>
    <div class="space-y-3">
        {% for cat in cats %}
        <div class="bg-slate-900/70 border border-white/5 rounded-2xl p-4 shadow-lg shadow-black/40">
            <div class="flex items-center gap-3 mb-3">
                {% if cat.photo_path %}
                <img src="{{ cat.photo_path }}" alt="{{ cat.name }}" class="h-14 w-14 rounded-2xl object-cover border border-white/10">
                {% else %}
                <div class="h-14 w-14 rounded-2xl bg-slate-800 flex items-center justify-center text-xl border border-white/10">{{ cat.name[:1] }}</div>
                {% endif %}
                <div>
                    <p class="font-semibold">{{ cat.name }}</p>
                    <p class="text-xs text-slate-500">
                        {% if cat.chip_id %}{{ t("cat_chip_label", lang) }}: {{ cat.chip_id }} Â· {% endif %}
                        {% if cat.birthday %}{{ t("cat_birthday_label", lang) }}: {{ cat.birthday }}{% endif %}
                    </p>
                    {% if not cat.is_active %}
                    <p class="text-xs text-amber-300">{{ t("cat_inactive", lang) }}</p>
                    {% endif %}
                </div>
            </div>
            <form method="post" action="/cats/{{ cat.id }}/update?lang={{ lang }}" enctype="multipart/form-data" class="space-y-2 text-sm">
                <input type="hidden" name="csrf_token" value="{{ request.session.get('csrf_token') }}">
                <input name="name" value="{{ cat.name }}" placeholder="{{ t('cat_name_label', lang) }}" required class="w-full bg-slate-800/80 border border-white/5 rounded-xl px-3 py-2 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <input name="color" value="{{ cat.color or '' }}" placeholder="{{ t('cat_color_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-2 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                    <input type="date" name="birthday" value="{{ cat.birthday }}" placeholder="{{ t('cat_birthday_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-2 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                </div>
                <input name="chip_id" value="{{ cat.chip_id or '' }}" placeholder="{{ t('cat_chip_label', lang) }}" class="bg-slate-800/80 border border-white/5 rounded-xl px-3 py-2 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40">
                <div class="flex items-center gap-2">
                    <label class="text-slate-400 text-xs flex-1 text-left">{{ t("cat_photo_label", lang) }}</label>
                    <input type="file" name="photo" accept="image/*" class="text-xs text-slate-300">
                </div>
                <label class="inline-flex items-center gap-2 text-xs text-slate-300">
                    <input type="checkbox" name="is_active" value="true" {% if cat.is_active %}checked{% endif %} class="accent-emerald-500">
                    <span>{{ t("cat_active_label", lang) }}</span>
                </label>
                <div class="flex gap-2 pt-2">
                    <button type="submit" class="flex-1 bg-white/10 hover:bg-white/20 text-slate-100 font-semibold px-3 py-2 rounded-xl border border-white/10 transition">{{ t("save_cat", lang) }}</button>
                </div>
            </form>
            <form method="post" action="/cats/{{ cat.id }}/delete?lang={{ lang }}" class="mt-2 inline-flex">
                <input type="hidden" name="csrf_token" value="{{ request.session.get('csrf_token') }}">
                <button type="submit" data-confirm="{{ t('delete_confirm', lang) }}" class="px-3 py-2 rounded-xl bg-red-500/20 hover:bg-red-500/30 text-red-100 border border-red-500/40">{{ t("delete_cat", lang) }}</button>
            </form>
        </div>
        {% else %}
        <div class="text-slate-400 text-sm">{{ t("no_cats_yet", lang) }}</div>
        {% endfor %}
    </div>
</div>
{% endblock %}
